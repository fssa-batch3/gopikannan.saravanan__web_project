<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PIN(People In Need).in</title>
    <link rel="stylesheet" href="../../Assets/css/donate.css" />
    <link rel="stylesheet" href="../../Assets/css/header.css" />
    <link rel="stylesheet" href="../../Assets/css/footer.css" />
    <link rel="stylesheet" href="../../Assets/css/universal.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link rel="stylesheet" href="../../Assets/js/donate.js" />
    <link rel="stylesheet" href="../../Assets/css/style.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700;800&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
    />
    <script type="text/javascript">
      function togglemenu() {
        document.getElementById("sidebar").classList.toggle("active");
      }
    </script>
  </head>
  <body>
    <!-- header starts -->
    <header></header>

    <!-- header end -->

    <!-- search box sec -->
    <div class="search"></div>
    <!-- search box sec -->

    <!-- script for refine search button -->
    <script>
      function myFunction() {
        document.getElementById("myDropdown").classList.toggle("show");
      }

      window.onclick = function (e) {
        if (!e.target.matches(".dropbtn")) {
          var myDropdown = document.getElementById("myDropdown");
          if (myDropdown.classList.contains("show")) {
            myDropdown.classList.remove("show");
          }
        }
      };
    </script>
    <!-- script ends -->
    <div class="container"></div>

    <!-- main container starts -->

    <!-- end container -->

    <div class="viewmore">
      <img
        src="../../Assets/images/arrow-down-sign-to-navigate.png"
        alt="arrow"
        class="arrow"
      />
      <div><a href="#" class="more">View More Fundraisers</a></div>
    </div>

    <!-- Footer  -->
    <div class="footer"></div>

    <!-- footer end -->

    <script src="../../Assets/js/footer.js"></script>

    <script>
      let json = [];
      let create_card = JSON.parse(localStorage.getItem("carddetails"));
      console.log(create_card);
      for (let i = 0; i < create_card.length; i++) {
        json.push(create_card[i]);
        console.log(json);
      }

      // URL PARAMS CODE TO SHOW THE AND FIND THE FILTER CONTENT

      const cause = window.location.search;
      const causeParams = new URLSearchParams(cause);
      const getcause = causeParams.get("cause");
      console.log(getcause);

      let anchordrop;
      anchordrop = document.createElement("a");
      anchordrop.setAttribute("href", "../../webpage/donate/My donations.html");
      document.querySelector(".search").append(anchordrop);

      let donationBtn;
      donationBtn = document.createElement("button");
      donationBtn.setAttribute("class", "donation");
      donationBtn.innerText = "My Donation";
      anchordrop.append(donationBtn);

      let inputSearch;
      inputSearch = document.createElement("input");
      inputSearch.setAttribute("type", "text");
      inputSearch.setAttribute(
        "placeholder",
        "Search by name,location,cause..."
      );
      inputSearch.setAttribute("name", "search");
      document.querySelector(".search").append(inputSearch);

      let sumbitBtn;
      sumbitBtn = document.createElement("button");
      sumbitBtn.setAttribute("type", "submit");
      document.querySelector(".search").append(sumbitBtn);

      let searchIcon;
      searchIcon = document.createElement("i");
      searchIcon.setAttribute("class", "fa fa-search");
      searchIcon.setAttribute("width", "20px");
      sumbitBtn.append(searchIcon);

      let dropDiv;
      dropDiv = document.createElement("div");
      dropDiv.setAttribute("class", "abc");
      document.querySelector(".search").append(dropDiv);

      let dropBtn;
      dropBtn = document.createElement("button");
      dropBtn.setAttribute("class", "dropbtn");
      dropBtn.setAttribute("onclick", "myFunction()");
      dropBtn.innerHTML = "Filter" + "&nbsp";
      dropDiv.append(dropBtn);

      let cartDownArrow;
      cartDownArrow = document.createElement("i");
      cartDownArrow.setAttribute("class", "fa fa-caret-down");
      cartDownArrow.setAttribute("style", "color: #f9f9f9");
      dropBtn.append(cartDownArrow);

      let dropdowncontentDiv;
      dropdowncontentDiv = document.createElement("div");
      dropdowncontentDiv.setAttribute("class", "dropdown-content");
      dropdowncontentDiv.setAttribute("id", "myDropdown");
      dropDiv.append(dropdowncontentDiv);

      let anchorMedical;
      anchorMedical = document.createElement("a");
      anchorMedical.setAttribute(
        "href",
        "../../webpage/donate/donateFilter.html?cause=" + "Medical"
      );
      anchorMedical.innerText = "Medical";
      dropdowncontentDiv.append(anchorMedical);

      let anchorEducation;
      anchorEducation = document.createElement("a");
      anchorEducation.setAttribute(
        "href",
        "../../webpage/donate/donateFilter.html?cause=" + "Educational"
      );
      anchorEducation.innerText = "Education";
      dropdowncontentDiv.append(anchorEducation);

      let anchorSocial;
      anchorSocial = document.createElement("a");
      anchorSocial.setAttribute(
        "href",
        "../../webpage/donate/donateFilter.html?cause=" + "Socialcause"
      );
      anchorSocial.innerText = "Social";
      dropdowncontentDiv.append(anchorSocial);

      for (let i = 0; i < json.length; i++) {
        let container_div;
        let card_div;
        let anchor;
        let span;
        let image;
        let h4_tag;
        let progress_div;
        let b_tag;
        let progress_tag;
        let progress_span_tag;
        let a_span_like;
        let a_span_share;
        let image_share;
        let amount_sec;
        let txt_amount;
        let cash;
        let count;
        let user_div;
        let user_name;
        let nameFundraise;

        // TO GET PERCENTAGE OF A CARD
        let amount = json[i]["amount_raised"];

        let expected_amount = json[i]["expected_amt"];

        let jsonCause = json[i]["drop"];
        console.log(jsonCause);

        let percentage = Math.floor((amount / expected_amount) * 100);

        // TO CLOSE A CARD WHEN ITS EXPECTED AMOUNT REACHED
        if (amount == expected_amount || amount >= expected_amount) {
          json[i]["amout"] = "reached";
        }
        // console.log(json[i]["amout"]);
        if (json[i]["amout"] == "unreach" && jsonCause == getcause) {
          // console.log(expected_amount);

          // search div &dropdown

          //   <div class="box"></div>
          card_div = document.createElement("div");
          card_div.setAttribute("class", "box");
          card_div.setAttribute("id", "content");
          // container_div.append(card_div);

          //<a></a>
          anchor = document.createElement("div");
          card_div.append(anchor);

          let a;
          a = document.createElement("a");
          a.setAttribute(
            "href",
            "../../webpage/donate/story.html?product_id=" +
              json[i]["product_id"]
          );
          anchor.append(a);

          //   <img class="image" src="../../Assets/images/education.jpg" alt="education" />
          image = document.createElement("img");
          image.setAttribute("class", "image");
          image.setAttribute("src", json[i]["img"]);
          image.setAttribute("onclick", "redirect()");
          image.setAttribute("alt", "education");
          a.append(image);

          //   <h4></h4>
          h4_tag = document.createElement("h4");
          h4_tag.innerText = json[i]["title"];
          anchor.append(h4_tag);

          //   <div class="progress-sec"></div>
          progress_div = document.createElement("div");
          progress_div.setAttribute("class", "progress-sec");
          anchor.append(progress_div);

          //   <b> 20%</b>

          b_tag = document.createElement("b");
          b_tag.innerText = percentage + "%";
          progress_div.append(b_tag);

          //   <progress id="file" value="32" max="100">20%</progress>
          progress_tag = document.createElement("progress");
          progress_tag.setAttribute("id", "file");
          progress_tag.setAttribute("value", percentage);
          progress_tag.setAttribute("max", "100");
          progress_div.append(progress_tag);

          //span
          progress_span_tag = document.createElement("span");
          progress_span_tag.setAttribute("class", "like");
          progress_div.append(progress_span_tag);

          // a
          a_span_share = document.createElement("a");
          a_span_share.setAttribute("href", "#");
          progress_span_tag.append(a_span_share);

          // img
          image_share = document.createElement("img");
          image_share.setAttribute("src", "../../Assets/images/share.png");
          image_share.setAttribute("class", "share");
          image_share.setAttribute("alt", "share");
          image_share.setAttribute("width", "30px");
          a_span_share.append(image_share);

          // <div class="amount">
          amount_sec = document.createElement("div");
          amount_sec.setAttribute("class", "amount");
          progress_div.append(amount_sec);

          // <span id="txt-amt"></span>
          txt_amount = document.createElement("span");
          txt_amount.setAttribute("id", "txt-amt");
          txt_amount.innerText = "Raised :";
          amount_sec.append(txt_amount);

          // <span id="cash"></span>
          cash = document.createElement("span");
          cash.setAttribute("id", "cash");

          cash.innerHTML = "RS." + json[i]["amount_raised"] + "&nbsp" + "&nbsp";

          amount_sec.append(cash);

          // <div class="user"></div>
          user_div = document.createElement("div");
          user_div.setAttribute("class", "user");
          anchor.append(user_div);

          // <span class="name-label"></span>
          user_name = document.createElement("span");
          user_name.setAttribute("class", "name-label");
          user_name.innerHTML = "Created by" + "&nbsp";
          user_div.append(user_name);

          // <span class="name"></span>
          nameFundraise = document.createElement("span");
          nameFundraise.setAttribute("class", "nameFundraiser");
          // name.setAttribute("style", "font-weight:bold");
          nameFundraise.innerText = json[i]["fundraiser"];
          user_div.append(nameFundraise);

          // console.log(json);
          document.querySelector(".container").append(card_div);
        }
      }
    </script>
    <script src="../../Assets/js/header.js"></script>
  </body>
</html>
